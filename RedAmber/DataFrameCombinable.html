<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: RedAmber::DataFrameCombinable
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "RedAmber::DataFrameCombinable";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../RedAmber.html" title="RedAmber (module)">RedAmber</a></span></span>
     &raquo; 
    <span class="title">DataFrameCombinable</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: RedAmber::DataFrameCombinable
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/red_amber/data_frame_combinable.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Mix-in for the class DataFrame</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#anti_join-instance_method" title="#anti_join (instance method)">#<strong>anti_join</strong>(other, join_keys = nil, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return records of self that do not have a match in other.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#concatenate-instance_method" title="#concatenate (instance method)">#<strong>concatenate</strong>(*other)  &#x21d2; DataFrame </a>
    

    
      (also: #concat, #bind_rows)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Concatenate other dataframes or tables onto the bottom of self.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#difference-instance_method" title="#difference (instance method)">#<strong>difference</strong>(other)  &#x21d2; DataFrame </a>
    

    
      (also: #setdiff)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Select records appearing in self but not in other.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#full_join-instance_method" title="#full_join (instance method)">#<strong>full_join</strong>(other, join_keys = nil, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
      (also: #outer_join)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Join another DataFrame or Table, leaving all records.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inner_join-instance_method" title="#inner_join (instance method)">#<strong>inner_join</strong>(other, join_keys = nil, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Join another DataFrame or Table, leaving only the matching records.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#intersect-instance_method" title="#intersect (instance method)">#<strong>intersect</strong>(other)  &#x21d2; DataFrame </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Select records appearing in both self and other.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#join-instance_method" title="#join (instance method)">#<strong>join</strong>(other, join_keys = nil, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#left_join-instance_method" title="#left_join (instance method)">#<strong>left_join</strong>(other, join_keys = nil, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Join matching values to self from other.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#merge-instance_method" title="#merge (instance method)">#<strong>merge</strong>(*other)  &#x21d2; DataFrame </a>
    

    
      (also: #bind_cols)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Merge other DataFrames or Tables.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#right_join-instance_method" title="#right_join (instance method)">#<strong>right_join</strong>(other, join_keys = nil, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Join matching values from self to other.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#semi_join-instance_method" title="#semi_join (instance method)">#<strong>semi_join</strong>(other, join_keys = nil, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return records of self that have a match in other.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_operable%3F-instance_method" title="#set_operable? (instance method)">#<strong>set_operable?</strong>(other)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if set operation with self and other is possible.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#union-instance_method" title="#union (instance method)">#<strong>union</strong>(other)  &#x21d2; DataFrame </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Select records appearing in self or other.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="anti_join-instance_method">
  
    
      <span class="overload">#<strong>anti_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>anti_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>anti_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return records of self that do not have a match in other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :left_anti`</p>
</li><li>
<p>A kind of filtering join.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>anti_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without key (use implicit common key)</p>
</div></p>
      
      <pre class="example code"><code>df.anti_join(other)

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 C              3</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>anti_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with a key</p>
</div></p>
      
      <pre class="example code"><code>df.anti_join(other, :KEY)

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 C              3</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>anti_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df2 = DataFrame.new(KEY1: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other2 = DataFrame.new(KEY2: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY2     X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with key pairs</p>
</div></p>
      
      <pre class="example code"><code>df2.anti_join(other2, { left: :KEY1, right: :KEY2 })

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 C              3</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


590
591
592</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 590</span>

<span class='kw'>def</span> <span class='id identifier rubyid_anti_join'>anti_join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:left_anti</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='id identifier rubyid_force_order'>force_order</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="concatenate-instance_method">
  
    #<strong>concatenate</strong>(*other)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='concat-instance_method'>concat</span>, <span id='bind_rows-instance_method'>bind_rows</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>the ‘#types` must be same as `other#types`.</p>
</div>
  </div>


<p>Concatenate other dataframes or tables onto the bottom of self.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df    = DataFrame.new(x: [1, 2], y: [&#39;A&#39;, &#39;B&#39;])
other = DataFrame.new(x: [3, 4], y: [&#39;C&#39;, &#39;D&#39;])
[df.types, other.types]

# =&gt;
[[:uint8, :string], [:uint8, :string]]

df.concatenate(other)

# =&gt;
        x y
  &lt;uint8&gt; &lt;string&gt;
0       1 A
1       2 B
2       3 C
3       4 D</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>, <tt>Array&lt;<span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span>, Arrow::Table&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>DataFrames or Tables to concatenate.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>concatenated dataframe.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_concatenate'>concatenate</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_other'>other</span>
  <span class='kw'>in</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='op'>|</span> <span class='lbracket'>[</span><span class='kw'>nil</span><span class='rbracket'>]</span> <span class='op'>|</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='kw'>self</span>
  <span class='kw'>in</span> <span class='lbracket'>[</span><span class='const'>Array</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_array'>array</span><span class='rbracket'>]</span>
    <span class='comment'># Nop
</span>  <span class='kw'>else</span>
    <span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_table_array'>table_array</span> <span class='op'>=</span> <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>when</span> <span class='const'>Arrow</span><span class='op'>::</span><span class='const'>Table</span>
      <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span>
      <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_table'>table</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a Table or a DataFrame</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_table'>table</span><span class='period'>.</span><span class='id identifier rubyid_concatenate'>concatenate</span><span class='lparen'>(</span><span class='id identifier rubyid_table_array'>table_array</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="difference-instance_method">
  
    #<strong>difference</strong>(other)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='setdiff-instance_method'>setdiff</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Select records appearing in self but not in other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :left_anti` when keys in self are same with other.</p>
</li><li>
<p>A kind of set operations.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df3 = DataFrame.new(
  KEY1: %w[A B C],
  KEY2: [1, 2, 3]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other3 = DataFrame.new(
  KEY1: %w[A B D],
  KEY2: [1, 4, 5]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              4
2 D              5</code></pre>
    
      
      <pre class="example code"><code>df3.intersect(other3)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 B              2
1 C              3

other.intersect(df)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 B              4
1 D              5</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


694
695
696
697
698
699
700</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 694</span>

<span class='kw'>def</span> <span class='id identifier rubyid_difference'>difference</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_keys'>keys</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keys are not same with self and other</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:left_anti</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="full_join-instance_method">
  
    
      <span class="overload">#<strong>full_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>full_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>full_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='outer_join-instance_method'>outer_join</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Join another DataFrame or Table, leaving all records.</p>
<ul><li>
<p>Same as ‘#join` with `type: :full_outer`</p>
</li><li>
<p>A kind of mutating join.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>full_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without key (use implicit common key)</p>
</div></p>
      
      <pre class="example code"><code>df.full_join(other)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)
3 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>full_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with a key</p>
</div></p>
      
      <pre class="example code"><code>df.full_join(other, :KEY)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)
3 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>full_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df2 = DataFrame.new(KEY1: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other2 = DataFrame.new(KEY2: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY2     X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with key pairs</p>
</div></p>
      
      <pre class="example code"><code>df2.full_join(other2, { left: :KEY1, right: :KEY2 })

# =&gt;
  KEY1          X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)
3 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


340
341
342
343</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 340</span>

<span class='kw'>def</span> <span class='id identifier rubyid_full_join'>full_join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span>
       <span class='label'>type:</span> <span class='symbol'>:full_outer</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='id identifier rubyid_force_order'>force_order</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inner_join-instance_method">
  
    
      <span class="overload">#<strong>inner_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>inner_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>inner_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Join another DataFrame or Table, leaving only the matching records.</p>
<ul><li>
<p>Same as ‘#join` with `type: :inner`</p>
</li><li>
<p>A kind of mutating join.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>inner_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without key (use implicit common key)</p>
</div></p>
      
      <pre class="example code"><code>df.inner_join(other)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>inner_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with a key</p>
</div></p>
      
      <pre class="example code"><code>df.inner_join(other, :KEY)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>inner_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df2 = DataFrame.new(KEY1: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other2 = DataFrame.new(KEY2: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY2     X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with key pairs</p>
</div></p>
      
      <pre class="example code"><code>df2.inner_join(other2, { left: :KEY1, right: :KEY2 })

# =&gt;
  KEY1          X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 275</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inner_join'>inner_join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:inner</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='id identifier rubyid_force_order'>force_order</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="intersect-instance_method">
  
    #<strong>intersect</strong>(other)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Select records appearing in both self and other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :inner` when keys in self are same with other.</p>
</li><li>
<p>A kind of set operations.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df3 = DataFrame.new(
  KEY1: %w[A B C],
  KEY2: [1, 2, 3]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other3 = DataFrame.new(
  KEY1: %w[A B D],
  KEY2: [1, 4, 5]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              4
2 D              5</code></pre>
    
      
      <pre class="example code"><code>df3.intersect(other3)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


629
630
631
632
633
634
635</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 629</span>

<span class='kw'>def</span> <span class='id identifier rubyid_intersect'>intersect</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_keys'>keys</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keys are not same with self and other</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:inner</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="join-instance_method">
  
    
      <span class="overload">#<strong>join</strong>(other, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>join</strong>(other, join_keys, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>join</strong>(other, join_key_pairs, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>the order of joined results will be preserved by default. This is enabled by appending index column to sort after joining but it will cause some performance degradation. If you don’t matter the order of the result, set ‘force_order` option to `false`.</p>
</div>
  </div>



  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>join</strong>(other, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
      <pre class="example code"><code>df.join(other)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false

df.join(other, type: :full_outer)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)
3 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>:left_semi</tt>, <tt>:right_semi</tt>, <tt>:left_anti</tt>, <tt>:right_anti</tt>, <tt>:inner</tt>, <tt>left_outer</tt>, <tt>:right_outer</tt>, <tt>:full_outer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:inner</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>type of join.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>join</strong>(other, join_keys, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df3 = DataFrame.new(
  KEY1: %w[A B C],
  KEY2: [1, 2, 3]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other3 = DataFrame.new(
  KEY1: %w[A B D],
  KEY2: [1, 4, 5]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              4
2 D              5</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>join keys in an Array</p>
</div></p>
      
      <pre class="example code"><code>df3.join(other3, [:KEY1, :KEY2])

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>partial join key and suffix</p>
</div></p>
      
      <pre class="example code"><code>df3.join(other3, :KEY1, suffix: &#39;.a&#39;)

# =&gt;
  KEY1        KEY2  KEY2.a
  &lt;string&gt; &lt;uint8&gt; &lt;uint8&gt;
0 A              1       1
1 B              2       4</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>:left_semi</tt>, <tt>:right_semi</tt>, <tt>:left_anti</tt>, <tt>:right_anti</tt>, <tt>:inner</tt>, <tt>left_outer</tt>, <tt>:right_outer</tt>, <tt>:full_outer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:inner</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>type of join.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>join</strong>(other, join_key_pairs, type: :inner, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df4 = DataFrame.new(
  X1: %w[A B C],
  Y: %w[D E F]
)

# =&gt;
  X1       Y1
  &lt;string&gt; &lt;string&gt;
0 A        D
1 B        E
2 C        F

other4 = DataFrame.new(
  X2: %w[A B D],
  Y:  %w[e E E]
)

# =&gt;
  X1       Y1
  &lt;string&gt; &lt;string&gt;
0 A        D
1 B        E
2 C        F</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without options</p>
</div></p>
      
      <pre class="example code"><code>df4.join(other4)

# =&gt;
  X1       Y        X2
  &lt;string&gt; &lt;string&gt; &lt;string&gt;
0 B        E        D
1 B        E        B</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>join by key pairs</p>
</div></p>
      
      <pre class="example code"><code>df4.join(other4, { left: [:X1, :Y], right: [:X2, :Y] })

# =&gt;
  X1       Y
  &lt;string&gt; &lt;string&gt;
0 B        E</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>join by key pairs, using renaming by suffix</p>
</div></p>
      
      <pre class="example code"><code>df4.join(other4, { left: :X1, right: :X2 })

# =&gt;
  X1       Y        Y.1
  &lt;string&gt; &lt;string&gt; &lt;string&gt;
0 A        D        e
1 B        E        E</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>:left_semi</tt>, <tt>:right_semi</tt>, <tt>:left_anti</tt>, <tt>:right_anti</tt>, <tt>:inner</tt>, <tt>left_outer</tt>, <tt>:right_outer</tt>, <tt>:full_outer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:inner</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>type of join.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 831</span>

<span class='kw'>def</span> <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:inner</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_right_table'>right_table</span> <span class='op'>=</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_other'>other</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span>
      <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_table'>table</span>
    <span class='kw'>when</span> <span class='const'>Arrow</span><span class='op'>::</span><span class='const'>Table</span>
      <span class='id identifier rubyid_other'>other</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>other must be a DataFrame or an Arrow::Table</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>end</span>

  <span class='id identifier rubyid_type'>type</span> <span class='op'>=</span> <span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
  <span class='id identifier rubyid_left_index'>left_index</span> <span class='op'>=</span> <span class='symbol'>:__LEFT_INDEX__</span>
  <span class='id identifier rubyid_right_index'>right_index</span> <span class='op'>=</span> <span class='symbol'>:__RIGHT_INDEX__</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_force_order'>force_order</span>
    <span class='id identifier rubyid_left_table'>left_table</span> <span class='op'>=</span> <span class='id identifier rubyid_assign'>assign</span><span class='lparen'>(</span><span class='id identifier rubyid_left_index'>left_index</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_indices'>indices</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_table'>table</span>
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Arrow</span><span class='op'>::</span><span class='const'>Table</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_right_table'>right_table</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_assign'>assign</span><span class='lparen'>(</span><span class='id identifier rubyid_right_index'>right_index</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_indices'>indices</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_table'>table</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_left_table'>left_table</span> <span class='op'>=</span> <span class='id identifier rubyid_table'>table</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_table_keys'>table_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_left_table'>left_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
  <span class='id identifier rubyid_other_keys'>other_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_right_table'>right_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>

  <span class='comment'># natural keys (implicit common keys)
</span>  <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>||=</span> <span class='id identifier rubyid_table_keys'>table_keys</span><span class='period'>.</span><span class='id identifier rubyid_intersection'>intersection</span><span class='lparen'>(</span><span class='id identifier rubyid_other_keys'>other_keys</span><span class='rparen'>)</span>

  <span class='comment'># This is not necessary if additional procedure is contributed to Red Arrow.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_join_keys'>join_keys</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_left_keys'>left_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_ensure_keys'>ensure_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_join_keys'>join_keys</span><span class='lbracket'>[</span><span class='symbol'>:left</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_right_keys'>right_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_ensure_keys'>ensure_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_join_keys'>join_keys</span><span class='lbracket'>[</span><span class='symbol'>:right</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_left_keys'>left_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_ensure_keys'>ensure_keys</span><span class='lparen'>(</span><span class='id identifier rubyid_join_keys'>join_keys</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_right_keys'>right_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_left_keys'>left_keys</span>
  <span class='kw'>end</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
  <span class='kw'>when</span> <span class='symbol'>:full_outer</span><span class='comma'>,</span> <span class='symbol'>:left_semi</span><span class='comma'>,</span> <span class='symbol'>:left_anti</span><span class='comma'>,</span> <span class='symbol'>:right_semi</span><span class='comma'>,</span> <span class='symbol'>:right_anti</span>
    <span class='id identifier rubyid_left_outputs'>left_outputs</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_right_outputs'>right_outputs</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>when</span> <span class='symbol'>:inner</span><span class='comma'>,</span> <span class='symbol'>:left_outer</span>
    <span class='id identifier rubyid_left_outputs'>left_outputs</span> <span class='op'>=</span> <span class='id identifier rubyid_table_keys'>table_keys</span>
    <span class='id identifier rubyid_right_outputs'>right_outputs</span> <span class='op'>=</span> <span class='id identifier rubyid_other_keys'>other_keys</span> <span class='op'>-</span> <span class='id identifier rubyid_right_keys'>right_keys</span>
  <span class='kw'>when</span> <span class='symbol'>:right_outer</span>
    <span class='id identifier rubyid_left_outputs'>left_outputs</span> <span class='op'>=</span> <span class='id identifier rubyid_table_keys'>table_keys</span> <span class='op'>-</span> <span class='id identifier rubyid_left_keys'>left_keys</span>
    <span class='id identifier rubyid_right_outputs'>right_outputs</span> <span class='op'>=</span> <span class='id identifier rubyid_other_keys'>other_keys</span>
  <span class='kw'>end</span>

  <span class='comment'># Should we rescue errors in Arrow::Table#join for usability ?
</span>  <span class='id identifier rubyid_joined_table'>joined_table</span> <span class='op'>=</span>
    <span class='id identifier rubyid_left_table'>left_table</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span>
      <span class='id identifier rubyid_right_table'>right_table</span><span class='comma'>,</span>
      <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span>
      <span class='label'>type:</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span>
      <span class='label'>left_outputs:</span> <span class='id identifier rubyid_left_outputs'>left_outputs</span><span class='comma'>,</span>
      <span class='label'>right_outputs:</span> <span class='id identifier rubyid_right_outputs'>right_outputs</span>
    <span class='rparen'>)</span>

  <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
  <span class='kw'>when</span> <span class='symbol'>:inner</span><span class='comma'>,</span> <span class='symbol'>:left_outer</span><span class='comma'>,</span> <span class='symbol'>:left_semi</span><span class='comma'>,</span> <span class='symbol'>:left_anti</span><span class='comma'>,</span> <span class='symbol'>:right_semi</span><span class='comma'>,</span> <span class='symbol'>:right_anti</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span> <span class='op'>=</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_joined_table'>joined_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
        <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='id identifier rubyid_joined_table'>joined_table</span><span class='comma'>,</span> <span class='id identifier rubyid_n_keys'>n_keys</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_joined_table'>joined_table</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='id identifier rubyid_sorter'>sorter</span> <span class='op'>=</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_type'>type</span>
      <span class='kw'>when</span> <span class='symbol'>:inner</span><span class='comma'>,</span> <span class='symbol'>:left_outer</span>
        <span class='lbracket'>[</span><span class='id identifier rubyid_left_index'>left_index</span><span class='comma'>,</span> <span class='id identifier rubyid_right_index'>right_index</span><span class='rbracket'>]</span>
      <span class='kw'>when</span> <span class='symbol'>:left_semi</span><span class='comma'>,</span> <span class='symbol'>:left_anti</span>
        <span class='lbracket'>[</span><span class='id identifier rubyid_left_index'>left_index</span><span class='rbracket'>]</span>
      <span class='kw'>when</span> <span class='symbol'>:right_semi</span><span class='comma'>,</span> <span class='symbol'>:right_anti</span>
        <span class='lbracket'>[</span><span class='id identifier rubyid_right_index'>right_index</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
  <span class='kw'>when</span> <span class='symbol'>:full_outer</span>
    <span class='id identifier rubyid_key_index_lr'>key_index_lr</span> <span class='op'>=</span>
      <span class='id identifier rubyid_left_keys'>left_keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_left_table'>left_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid__1'>_1</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
        <span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='id identifier rubyid_right_keys'>right_keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_left_table'>left_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>+</span> <span class='id identifier rubyid_right_table'>right_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='id identifier rubyid__1'>_1</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_renamed_table'>renamed_table</span> <span class='op'>=</span> <span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='id identifier rubyid_joined_table'>joined_table</span><span class='comma'>,</span> <span class='id identifier rubyid_n_keys'>n_keys</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_dropper'>dropper</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span> <span class='op'>=</span>
      <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_renamed_table'>renamed_table</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_assign'><span class='object_link'><a href="DataFrameVariableOperation.html#assign-instance_method" title="RedAmber::DataFrameVariableOperation#assign (method)">assign</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_df'>df</span><span class='op'>|</span>
        <span class='id identifier rubyid_key_index_lr'>key_index_lr</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_l'>l</span><span class='comma'>,</span> <span class='id identifier rubyid_r'>r</span><span class='op'>|</span>
          <span class='id identifier rubyid_dropper'>dropper</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='lbracket'>[</span><span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span>
          <span class='lbracket'>[</span><span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='lbracket'>[</span><span class='id identifier rubyid_l'>l</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_merge_array'>merge_array</span><span class='lparen'>(</span><span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_vectors'>vectors</span><span class='lbracket'>[</span><span class='id identifier rubyid_l'>l</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_vectors'>vectors</span><span class='lbracket'>[</span><span class='id identifier rubyid_r'>r</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='rparen'>)</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span> <span class='op'>=</span> <span class='id identifier rubyid_dataframe'>dataframe</span><span class='period'>.</span><span class='id identifier rubyid_drop'>drop</span><span class='lparen'>(</span><span class='id identifier rubyid_dropper'>dropper</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sorter'>sorter</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_left_index'>left_index</span><span class='comma'>,</span> <span class='id identifier rubyid_right_index'>right_index</span><span class='rbracket'>]</span>
  <span class='kw'>when</span> <span class='symbol'>:right_outer</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span> <span class='op'>=</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_joined_table'>joined_table</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_uniq!'>uniq!</span>
        <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_rename_table'>rename_table</span><span class='lparen'>(</span><span class='id identifier rubyid_joined_table'>joined_table</span><span class='comma'>,</span> <span class='id identifier rubyid_left_outputs'>left_outputs</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_joined_table'>joined_table</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span> <span class='op'>=</span> <span class='id identifier rubyid_dataframe'>dataframe</span><span class='period'>.</span><span class='id identifier rubyid_pick'>pick</span><span class='lparen'>(</span><span class='id identifier rubyid_right_keys'>right_keys</span><span class='comma'>,</span> <span class='id identifier rubyid_dataframe'>dataframe</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>-</span> <span class='id identifier rubyid_right_keys'>right_keys</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sorter'>sorter</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_left_index'>left_index</span><span class='comma'>,</span> <span class='id identifier rubyid_right_index'>right_index</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_force_order'>force_order</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span>
      <span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='lparen'>(</span><span class='id identifier rubyid_sorter'>sorter</span><span class='rparen'>)</span>
      <span class='period'>.</span><span class='id identifier rubyid_drop'>drop</span><span class='lparen'>(</span><span class='id identifier rubyid_sorter'>sorter</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_dataframe'>dataframe</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="left_join-instance_method">
  
    
      <span class="overload">#<strong>left_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>left_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>left_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Join matching values to self from other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :left_outer`</p>
</li><li>
<p>A kind of mutating join.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>left_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without key (use implicit common key)</p>
</div></p>
      
      <pre class="example code"><code>df.left_join(other)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>left_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with a key</p>
</div></p>
      
      <pre class="example code"><code>df.left_join(other, :KEY)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>left_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df2 = DataFrame.new(KEY1: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other2 = DataFrame.new(KEY2: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY2     X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with key pairs</p>
</div></p>
      
      <pre class="example code"><code>df2.left_join(other2, { left: :KEY1, right: :KEY2 })

# =&gt;
  KEY1          X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 C              3 (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


405
406
407</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 405</span>

<span class='kw'>def</span> <span class='id identifier rubyid_left_join'>left_join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:left_outer</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='id identifier rubyid_force_order'>force_order</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="merge-instance_method">
  
    #<strong>merge</strong>(*other)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='bind_cols-instance_method'>bind_cols</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>the ‘#size` must be same as `other#size`.</p>
</div>
  </div>

  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>self and other must not share the same key.</p>
</div>
  </div>


<p>Merge other DataFrames or Tables.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df    = DataFrame.new(x: [1, 2], y: [3, 4])
other = DataFrame.new(a: [&#39;A&#39;, &#39;B&#39;], b: [&#39;C&#39;, &#39;D&#39;])
df.merge(other)

# =&gt;
        x       y a        b
  &lt;uint8&gt; &lt;uint8&gt; &lt;string&gt; &lt;string&gt;
0       1       3 A        C
1       2       4 B        D</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>, <tt>Array&lt;<span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span>, Arrow::Table&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>DataFrames or Tables to merge.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>merged dataframe.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>if size is not same or self and other shares the same key.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_other'>other</span>
  <span class='kw'>in</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='op'>|</span> <span class='lbracket'>[</span><span class='kw'>nil</span><span class='rbracket'>]</span> <span class='op'>|</span> <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
    <span class='kw'>return</span> <span class='kw'>self</span>
  <span class='kw'>in</span> <span class='lbracket'>[</span><span class='const'>Array</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_array'>array</span><span class='rbracket'>]</span>
    <span class='comment'># Nop
</span>  <span class='kw'>else</span>
    <span class='id identifier rubyid_array'>array</span> <span class='op'>=</span> <span class='id identifier rubyid_other'>other</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_h'>h</span><span class='op'>|</span>
    <span class='id identifier rubyid_df'>df</span> <span class='op'>=</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_e'>e</span>
      <span class='kw'>when</span> <span class='const'>Arrow</span><span class='op'>::</span><span class='const'>Table</span>
        <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span><span class='period'>.</span><span class='id identifier rubyid_create'><span class='object_link'><a href="DataFrame.html#create-class_method" title="RedAmber::DataFrame.create (method)">create</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></span>
        <span class='id identifier rubyid_e'>e</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a Table or a DataFrame</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_size'>size</span> <span class='op'>!=</span> <span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_content'> do not have same size as self</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_k'>k</span> <span class='op'>=</span> <span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_intersection'>intersection</span><span class='lparen'>(</span><span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are some shared keys: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span>

    <span class='id identifier rubyid_h'>h</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='id identifier rubyid_df'>df</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_assign'>assign</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="right_join-instance_method">
  
    
      <span class="overload">#<strong>right_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>right_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>right_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Join matching values from self to other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :right_outer`</p>
</li><li>
<p>A kind of mutating join.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>right_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without key (use implicit common key)</p>
</div></p>
      
      <pre class="example code"><code>df.right_join(other)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>right_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with a key</p>
</div></p>
      
      <pre class="example code"><code>df.right_join(other, :KEY)

# =&gt;
  KEY           X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>right_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df2 = DataFrame.new(KEY1: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other2 = DataFrame.new(KEY2: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY2     X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with key pairs</p>
</div></p>
      
      <pre class="example code"><code>df2.right_join(other2, { left: :KEY1, right: :KEY2 })

# =&gt;
  KEY1          X1 X2
  &lt;string&gt; &lt;uint8&gt; &lt;boolean&gt;
0 A              1 true
1 B              2 false
2 D          (nil) (nil)</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


467
468
469
470
471
472
473
474
475</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 467</span>

<span class='kw'>def</span> <span class='id identifier rubyid_right_join'>right_join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span>
    <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span>
    <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span>
    <span class='label'>type:</span> <span class='symbol'>:right_outer</span><span class='comma'>,</span>
    <span class='label'>suffix:</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span>
    <span class='label'>force_order:</span> <span class='id identifier rubyid_force_order'>force_order</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="semi_join-instance_method">
  
    
      <span class="overload">#<strong>semi_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>semi_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
      <span class="overload">#<strong>semi_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return records of self that have a match in other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :left_semi`</p>
</li><li>
<p>A kind of filtering join.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">#<strong>semi_join</strong>(other, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>If ‘join_key` is not specified, common keys in self and other are used (natural keys). Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>without key (use implicit common key)</p>
</div></p>
      
      <pre class="example code"><code>df.semi_join(other)

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>semi_join</strong>(other, join_keys, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df = DataFrame.new(KEY: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other = DataFrame.new(KEY: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY      X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with a key</p>
</div></p>
      
      <pre class="example code"><code>df.semi_join(other, :KEY)

# =&gt;
  KEY           X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_keys</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a key or keys to match.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">#<strong>semi_join</strong>(other, join_key_pairs, suffix: &#39;.1&#39;, force_order: true)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    
<p>Returns joined dataframe.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df2 = DataFrame.new(KEY1: %w[A B C], X1: [1, 2, 3])

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other2 = DataFrame.new(KEY2: %w[A B D], X2: [true, false, nil])

# =&gt;
  KEY2     X2
  &lt;string&gt; &lt;boolean&gt;
0 A        true
1 B        false
2 D        (nil)</code></pre>
    
      
        <p class="example_title"><div class='inline'>
<p>with key pairs</p>
</div></p>
      
      <pre class="example code"><code>df2.semi_join(other2, { left: :KEY1, right: :KEY2 })

# =&gt;
  KEY1          X1
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>join_key_pairs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pairs of a key name or key names to match in left and right.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>force_order</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wheather force order of the output always same.</p>
<ul><li>
<p>This option is used in ‘:full_outer` and `:right_outer`.</p>
</li><li>
<p>If this option is true (by default) it will append index to the source and sort after joining. It will cause some degradation in performance.</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>suffix</span>
      
      
        <span class='type'>(<tt>#succ</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;.1&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a suffix to rename keys when key names conflict as a result of join. ‘suffix` must be responsible to `#succ`.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>join_key_pairs</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:left</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘self`.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:right</span>
          <span class="type">(<tt>String</tt>, <tt>Symbol</tt>, <tt>Array&lt;String, Symbol&gt;</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>join keys in ‘other`.</p>
</div>
          
        </li>
      
    </ul>
  
    
    
    
    

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>

<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


534
535
536</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 534</span>

<span class='kw'>def</span> <span class='id identifier rubyid_semi_join'>semi_join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.1</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_join_keys'>join_keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:left_semi</span><span class='comma'>,</span> <span class='label'>suffix:</span> <span class='id identifier rubyid_suffix'>suffix</span><span class='comma'>,</span> <span class='label'>force_order:</span> <span class='id identifier rubyid_force_order'>force_order</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_operable?-instance_method">
  
    #<strong>set_operable?</strong>(other)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if set operation with self and other is possible.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df3 = DataFrame.new(
  KEY1: %w[A B C],
  KEY2: [1, 2, 3]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other3 = DataFrame.new(
  KEY1: %w[A B D],
  KEY2: [1, 4, 5]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              4
2 D              5</code></pre>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_df3'>df3</span><span class='period'>.</span><span class='id identifier rubyid_set_operable?'>set_operable?</span><span class='lparen'>(</span><span class='id identifier rubyid_other3'>other3</span><span class='rparen'>)</span> <span class='comment'># =&gt; true</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if set operation is possible.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


607
608
609</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 607</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_operable?'>set_operable?</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span> <span class='comment'># rubocop:disable Naming/AccessorMethodName
</span>  <span class='id identifier rubyid_keys'>keys</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="union-instance_method">
  
    #<strong>union</strong>(other)  &#x21d2; <tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Select records appearing in self or other.</p>
<ul><li>
<p>Same as ‘#join` with `type: :full_outer` when keys in self are same with other.</p>
</li><li>
<p>A kind of set operations.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code>df3 = DataFrame.new(
  KEY1: %w[A B C],
  KEY2: [1, 2, 3]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3

other3 = DataFrame.new(
  KEY1: %w[A B D],
  KEY2: [1, 4, 5]
)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              4
2 D              5</code></pre>
    
      
      <pre class="example code"><code>df3.intersect(other3)

# =&gt;
  KEY1        KEY2
  &lt;string&gt; &lt;uint8&gt;
0 A              1
1 B              2
2 C              3
3 B              4
4 D              5</code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>, <tt>Arrow::Table</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A DataFrame or a Table to be joined with self.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="DataFrame.html" title="RedAmber::DataFrame (class)">DataFrame</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>joined dataframe.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>0.2.3</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


659
660
661
662
663
664
665</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/red_amber/data_frame_combinable.rb', line 659</span>

<span class='kw'>def</span> <span class='id identifier rubyid_union'>union</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_keys'>keys</span> <span class='op'>==</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="DataFrameArgumentError.html" title="RedAmber::DataFrameArgumentError (class)">DataFrameArgumentError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>keys are not same with self and other</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_keys'>keys</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='symbol'>:full_outer</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Apr 28 20:58:10 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.2.2).
</div>

    </div>
  </body>
</html>